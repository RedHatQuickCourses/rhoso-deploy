<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Create the OpenStack Control Plane :: RHOSP18 - Provision Control Plane Services and Manage Data Plane Nodes</title>
    <link rel="prev" href="section4.html">
    <link rel="next" href="section6.html">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://www.redhat.com" target="_blank"><img src="../../../_/img/redhat-logo.png" height="40px" alt="Red Hat"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="../../..">RHOSP18 - Provision Control Plane Services and Manage Data Plane Nodes</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://github.com/RedHatQuickCourses/changeme/issues" target="_blank">Report Issues</a>
      </div>
    </div>
  </nav>
</header><div class="body">
<div class="nav-container" data-component="rhods-deploy" data-version="1.34">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">RHOSP18 - Provision Control Plane Services and Manage Data Plane Nodes</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Home</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="section0.html">Traditional TripleO deployment verses deployment with OpenShift cluster.</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="section1.html">RHOSO installation process overview</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="section2.html">Perform Prerequisite Operations</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="section3.html">Install the OpenStack Operator</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="section4.html">Preparing RHOCP for RHOSP Network Isolation</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="section5.html">Create the OpenStack Control Plane</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="section6.html">Verify OpenStack Controlplane configuration</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="section7.html">Create the Data Plane</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="section8.html">Verify Dataplane deployment</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="section9.html">Access OpenStack</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">RHOSP18 - Provision Control Plane Services and Manage Data Plane Nodes</span>
    <span class="version">1.34</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">RHOSP18 - Provision Control Plane Services and Manage Data Plane Nodes</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">1.34</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">RHOSP18 - Provision Control Plane Services and Manage Data Plane Nodes</a></li>
    <li><a href="section5.html">Create the OpenStack Control Plane</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Create the OpenStack Control Plane</h1>
<div class="sect1">
<h2 id="_overview"><a class="anchor" href="#_overview"></a>Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We will be using a preconfigured file (<strong>files/osp-ng-ctlplane-deploy.yaml</strong>) to create the control plane and at the same time enable the required services, configure the control plane network, and configure the service back ends.</p>
</div>
<div class="paragraph">
<p>Sample configuration files in the form of Validated Architectures (VAs) may be provided as Feature Pack after release of RHOSP18.
These will be made available in the form of kustomize YAML files.</p>
</div>
<div class="paragraph">
<p>Kustomize is a Kubernetes-native deployment tool that enables customization of YAML files without altering the original.
It simplifies resource configuration by allowing base templates to be customized with user data, eliminating the need to write manifests from scratch.
This abstraction streamlines resource management, enabling users to focus solely on relevant details without requiring full knowledge of Kubernetes YAML structures.</p>
</div>
<div class="paragraph">
<p>The current onfiguration is derived from the upstream templates available here:
<a href="https://github.com/openstack-k8s-operators/openstack-operator/blob/dev-preview3/config/samples/" class="bare">https://github.com/openstack-k8s-operators/openstack-operator/blob/dev-preview3/config/samples/</a></p>
</div>
<div class="paragraph">
<p>In this deployment, the bastion has a preconfigured NFS service that we will be using to store glance images and cinder volumes.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create an NFS share for cinder</p>
<div class="listingblock execute">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mkdir /nfs/cinder
chmod 777 /nfs/cinder</code></pre>
</div>
</div>
</li>
<li>
<p>Configure NFS storage class</p>
<div class="listingblock execute">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mkdir /nfs/pv6
mkdir /nfs/pv7
mkdir /nfs/pv8
mkdir /nfs/pv9
mkdir /nfs/pv10
mkdir /nfs/pv11
chmod 777 /nfs/pv*</code></pre>
</div>
</div>
<div class="listingblock execute">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc create -f nfs-storage.yaml</code></pre>
</div>
</div>
</li>
<li>
<p>Prepare the secret to place the NFS server connection used by Cinder</p>
<div class="listingblock execute">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc create secret generic cinder-nfs-config --from-file=nfs-cinder-conf</code></pre>
</div>
</div>
</li>
<li>
<p>Prepare the secret to place the server connection used by Glance</p>
<div class="listingblock execute">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc create secret generic glance-cinder-config --from-file=glance-conf</code></pre>
</div>
</div>
</li>
<li>
<p>Finally create the OpenStack control plane</p>
<div class="listingblock execute">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc create -f osp-ng-ctlplane-deploy.yaml</code></pre>
</div>
</div>
</li>
<li>
<p>Wait until the OpenStack control plane deployment is completed:</p>
<div class="listingblock execute">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc get openstackcontrolplane -n openstack</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
This can take several minutes.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Repeat the query until MESSAGE is Setup complete</p>
</div>
<div class="listingblock">
<div class="title">Sample Output</div>
<div class="content">
<pre>NAME                                 STATUS   MESSAGE
openstack-galera-network-isolation   True     Setup complete</pre>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="section4.html">Preparing RHOCP for RHOSP Network Isolation</a></span>
  <span class="next"><a href="section6.html">Verify OpenStack Controlplane configuration</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <img src="../../../_/img/rhl-logo-red.png" height="40px" alt="Red Hat"  href="https://redhat.com" >
</footer><script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
